<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>食谱详情 - 美食天地</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/css/style.css">
    <style>
        .detail-container { max-width: 1200px; margin: 40px auto; background: rgba(245, 230, 210, 0.95); padding: 40px; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); border: 1px solid #d9b38c; }
        .recipe-header { display: flex; align-items: center; border-bottom: 1px solid #e0cdb6; padding-bottom: 20px; margin-bottom: 30px; }
        .author-avatar { width: 60px; height: 60px; border-radius: 50%; border: 3px solid #fff; margin-right: 15px; object-fit: cover; }
        .recipe-main-img { width: 100%; height: 400px; object-fit: cover; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .recipe-title { font-size: 32px; color: #664b2e; font-family: "楷体"; text-align: center; margin-bottom: 10px; }
        .recipe-meta { text-align: center; margin-bottom: 30px; color: #888; }
        .cuisine-tag { background: #f7941e; color: white; padding: 4px 12px; border-radius: 20px; font-size: 14px; margin-left: 10px; }
        .section-title { font-size: 22px; color: #f7941e; margin: 40px 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #e0cdb6; }
        .text-content { line-height: 1.8; color: #555; white-space: pre-wrap; font-size: 16px; }

        /* 评论模态框样式 */
        .comment-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center; }
        .comment-modal-content { background: #fff; width: 90%; max-width: 700px; max-height: 85vh; border-radius: 10px; display: flex; flex-direction: column; overflow: hidden; }
        .comment-header { padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; background: #fffaf0; }
        .comment-body { padding: 20px; overflow-y: auto; flex: 1; }
        .comment-footer { padding: 15px 20px; border-top: 1px solid #eee; background: #fff; }

        .comment-item { display: flex; gap: 15px; border-bottom: 1px solid #f0f0f0; padding: 15px 0; }
        .comment-avatar-small { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }

        .view-comment-btn {
            display: block; width: 100%; max-width: 300px; margin: 40px auto 0;
            padding: 12px; background: #f7941e; color: white; border: none; border-radius: 25px;
            font-size: 16px; cursor: pointer; transition: 0.3s;
        }
        .view-comment-btn:hover { background: #e67e22; transform: translateY(-2px); }

        .rating-group { display: flex; flex-direction: row-reverse; justify-content: flex-end; margin-bottom: 10px; }
        .rating-group input { display: none; }
        .rating-group label { color: #ddd; font-size: 24px; cursor: pointer; padding: 0 2px; }
        .rating-group input:checked ~ label, .rating-group label:hover, .rating-group label:hover ~ label { color: #f7941e; }
    </style>
</head>
<body>
<nav class="navbar">
    <div class="nav-title"><i class="fas fa-utensils"></i><span>美食天地</span></div>
    <div class="nav-center">
        <ul class="nav-links">
            <li><a href="index.html">首页</a></li>
            <li><a href="cuisine.html">菜系分类</a></li>
            <li><a href="recommendation.html">菜品推荐</a></li>
            <li><a href="market.html">食材商城</a></li>
            <li><a href="my_recipes.html">我的食谱</a></li>
            <li><a href="profile.html">个人中心</a></li>
            <li><a href="admin.html">后台管理</a></li>
            <li id="authSection"><a href="register.html">登录/注册</a></li>
        </ul>
    </div>
</nav>

<div class="detail-container" id="recipeContainer">
    <p style="text-align: center; padding: 50px;">加载中...</p>
</div>

<div id="commentModal" class="comment-modal">
    <div class="comment-modal-content">
        <div class="comment-header">
            <h3 style="margin:0; color:#664b2e;"><i class="fas fa-comments"></i> 食客评价</h3>
            <span onclick="closeCommentModal()" style="font-size:24px; cursor:pointer; color:#999;">&times;</span>
        </div>
        <div class="comment-body">
            <div id="commentList"></div>
        </div>
        <div class="comment-footer">
            <div style="margin-bottom: 10px;">
                <label style="font-weight:bold; color:#664b2e;">评分：</label>
                <div class="rating-group" style="display:inline-flex;">
                    <input type="radio" name="rating" id="r5" value="5" checked><label for="r5">★</label>
                    <input type="radio" name="rating" id="r4" value="4"><label for="r4">★</label>
                    <input type="radio" name="rating" id="r3" value="3"><label for="r3">★</label>
                    <input type="radio" name="rating" id="r2" value="2"><label for="r2">★</label>
                    <input type="radio" name="rating" id="r1" value="1"><label for="r1">★</label>
                </div>
            </div>
            <textarea id="commentContent" style="width:100%; height:60px; padding:10px; border:1px solid #ddd; border-radius:4px; margin-bottom:10px;" placeholder="分享你的烹饪心得..."></textarea>
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div style="position:relative;">
                    <button type="button" onclick="document.getElementById('commentFile').click()" style="border:1px dashed #d9b38c; background:none; padding:5px 10px; cursor:pointer; color:#664b2e; border-radius:4px;">
                        <i class="fas fa-camera"></i> 上传图片
                    </button>
                    <input type="file" id="commentFile" accept="image/*" style="display:none" onchange="previewImage(this)">
                    <span id="fileName" style="font-size:12px; color:#999; margin-left:5px;"></span>
                </div>
                <button onclick="submitComment()" style="background:#f7941e; color:white; border:none; padding:8px 20px; border-radius:20px; cursor:pointer; font-weight:bold;">发送</button>
            </div>
            <img id="imgPreview" style="max-height:60px; margin-top:10px; display:none; border-radius:4px;">
        </div>
    </div>
</div>

<footer class="footer">
    <p>联系我们：<a href="https://www.nchu.edu.cn/" target="_blank">南昌航空大学官网</a></p>
</footer>
<script src="static/js/common.js"></script>
<script src="static/js/recipe_detail.js"></script>
</body>
</html>