<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美食天地 - 食材商城</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/market.css">

</head>
<body>
<nav class="navbar">
    <div class="nav-title">
        <i class="fas fa-utensils"></i>
        <span>美食天地</span>
    </div>
    <div class="nav-center">
        <ul class="nav-links">
            <li><a href="index.html">首页</a></li>
            <li><a href="cuisine.html">菜系分类</a></li>
            <li><a href="recommendation.html">菜品推荐</a></li>
            <li><a href="market.html" style="background-color: rgba(255,255,255,0.2);">食材商城</a></li>
            <li><a href="my_recipes.html">我的食谱</a></li>
            <li><a href="profile.html">个人中心</a></li>
            <li><a href="admin.html">后台管理</a></li>
            <li id="authSection"><a href="register.html">登录/注册</a></li>
        </ul>
    </div>
</nav>

<div class="page-content">
    <h1 class="page-title">新鲜食材商城</h1>

    <div class="search-container">
        <input type="text" id="productSearchInput" class="search-input" placeholder="搜索食材...">
        <button onclick="searchProducts()" class="search-btn"><i class="fas fa-search"></i> 搜索</button>
    </div>

    <div class="categories" id="categories">
    </div>

    <div class="products-grid" id="productsGrid">
    </div>

    <div id="productPagination" class="pagination"></div>
</div>

<div class="cart-modal" id="cartModal">
    <div class="cart-modal-content">
        <div class="cart-modal-header">
            <h2 class="cart-modal-title">
                <i class="fas fa-shopping-cart"></i> 我的购物车
            </h2>
            <button class="close-cart" onclick="closeCart()">&times;</button>
        </div>
        <div class="cart-items" id="cartItems"></div>
        <div class="cart-total" id="cartTotal">
            <span>合计:</span>
            <span>¥0.00</span>
        </div>
        <div class="cart-actions">
            <button class="continue-shopping-btn" onclick="closeCart()">继续购物</button>
            <button class="checkout-btn" onclick="checkout()" disabled>去结算</button>
        </div>
    </div>
</div>

<div class="cart-modal" id="listModal">
    <div class="cart-modal-content">
        <div class="cart-modal-header">
            <h2 class="cart-modal-title">
                <i class="fas fa-clipboard-list"></i> 待买清单
            </h2>
            <button class="close-cart" onclick="closeShoppingList()">&times;</button>
        </div>

        <div style="display: flex; gap: 10px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px dashed #eee;">
            <input type="text" id="listNewItem" placeholder="添加物品 (如: 鸡蛋)"
                   style="flex: 1; padding: 10px; border: 1px solid #d9b38c; border-radius: 5px;"
                   onkeypress="if(event.keyCode==13) document.getElementById('listNewQty').focus()">
            <input type="text" id="listNewQty" placeholder="用量"
                   style="width: 80px; padding: 10px; border: 1px solid #d9b38c; border-radius: 5px;"
                   onkeypress="if(event.keyCode==13) addListItem()">
            <button class="btn-primary" onclick="addListItem()" style="padding: 0 15px; border-radius: 5px; border:none;">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="cart-items" style="max-height: 400px; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin: 10px 0;">
                <h4 style="margin: 0; color: #664b2e;">待买</h4>
                <button onclick="clearTodoList()" style="color: #666; background: #f0f0f0; border:none; padding: 4px 10px; border-radius: 4px; font-size: 12px; cursor: pointer;">清空待买</button>
            </div>
            <div id="todoListItems"></div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; border-top: 2px solid #eee; padding-top: 10px;">
                <h4 style="margin: 0; color: #664b2e;">已买</h4>
                <button onclick="clearBoughtList()" style="color: #666; background: #f0f0f0; border:none; padding: 4px 10px; border-radius: 4px; font-size: 12px; cursor: pointer;">清空已买</button>
            </div>
            <div id="boughtListItems"></div>
        </div>
    </div>
</div>
<div class="cart-modal" id="addressSelectionModal">
    <div class="cart-modal-content" style="max-width: 500px;">
        <div class="cart-modal-header">
            <h2 class="cart-modal-title"><i class="fas fa-map-marker-alt"></i> 确认收货地址</h2>
            <button class="close-cart" onclick="closeAddressModal()">&times;</button>
        </div>

        <div style="padding: 10px 0;">
            <h4 style="margin-bottom: 10px; color: #664b2e;">选择已有地址：</h4>
            <div id="selectableAddressList" style="max-height: 200px; overflow-y: auto; margin-bottom: 20px;">
            </div>

            <div style="border-top: 1px dashed #d9b38c; padding-top: 15px; margin-top: 10px;">
                <h4 style="margin-bottom: 10px; color: #664b2e;">或 使用新地址：</h4>
                <input type="text" id="newReceiver" placeholder="收货人姓名" style="width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;">
                <input type="text" id="newPhone" placeholder="联系电话" style="width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;">
                <textarea id="newAddress" placeholder="详细地址" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" rows="2"></textarea>
            </div>
        </div>

        <div class="cart-actions">
            <button class="continue-shopping-btn" onclick="closeAddressModal()">取消</button>
            <button class="checkout-btn" onclick="proceedToPayment()">下一步：支付</button>
        </div>
    </div>
</div>

<div class="cart-modal" id="paymentModal">
    <div class="cart-modal-content" style="max-width: 400px; text-align: center;">
        <div class="cart-modal-header">
            <h2 class="cart-modal-title"><i class="fas fa-credit-card"></i> 选择支付方式</h2>
            <button class="close-cart" onclick="closePaymentModal()">&times;</button>
        </div>

        <div style="padding: 20px 0; text-align: left;">
            <div style="margin-bottom: 15px; padding: 10px; border: 1px solid #eee; border-radius: 8px; cursor: pointer;" onclick="document.getElementById('payWechat').checked=true">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="radio" name="paymentMethod" id="payWechat" value="wechat" checked>
                    <i class="fab fa-weixin" style="color: #09bb07; font-size: 24px; margin: 0 10px;"></i>
                    <span style="font-weight: bold;">微信支付</span>
                </label>
            </div>
            <div style="margin-bottom: 15px; padding: 10px; border: 1px solid #eee; border-radius: 8px; cursor: pointer;" onclick="document.getElementById('payAlipay').checked=true">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="radio" name="paymentMethod" id="payAlipay" value="alipay">
                    <i class="fab fa-alipay" style="color: #108ee9; font-size: 24px; margin: 0 10px;"></i>
                    <span style="font-weight: bold;">支付宝</span>
                </label>
            </div>
        </div>

        <div class="cart-actions" style="justify-content: center;">
            <button class="checkout-btn" onclick="finalSubmitOrder()" style="width: 100%;">确认支付并下单</button>
        </div>
    </div>
</div>
<script src="static/js/market.js"></script>
<script src="static/js/common.js"></script>
<footer class="footer">
    <p>美食天地 - 新鲜食材直达 | 客服热线：400-123-4567 | 邮箱：service@foodheaven.com</p>
    <p>&copy; 2024 美食天地 版权所有 | 分享每一刻的美味时光</p>
</footer>
</body>
</html>
